/*
** NOTE: This file is generated by Gulp and should not be edited directly!
** Any changes made directly to this file will be overwritten next time its asset group is processed by Gulp.
*/

angular
    .module("LayoutEditor")
    .directive("orcLayoutTile", ["scopeConfigurator", "environment",
        function (scopeConfigurator, environment) {
            return {
                restrict: "E",
                scope: { element: "=" },
                controller: ["$scope", "$element", "$attrs",
                    function ($scope, $element, $attrs) {
                        scopeConfigurator.configureForElement($scope, $element);
                        scopeConfigurator.configureForContainer($scope, $element);
                        $scope.sortableOptions["axis"] = "y";
                    }
                ],
                templateUrl: environment.templateUrl("Tile"),
                replace: true,
                link: function ($scope, $element, $attrs) {
                    $element.on("change", "[ng-model='element.backgroundSize']", function () {
                        $scope.element.applyBackground();
                    });
                }
            };
        }
    ]);
var LayoutEditor;
(function (LayoutEditor) {

    LayoutEditor.Tile = function (data, contentType, htmlId, htmlClass, htmlStyle, isTemplated, rule, hasEditor, backgroundUrl, backgroundSize, children) {
        var self = this;

        // Inherit from the Element base class.
        LayoutEditor.Element.call(self, "Tile", data, htmlId, htmlClass, htmlStyle, isTemplated, rule);

        // Inherit from the Container base class.
        LayoutEditor.Container.call(self, ["Canvas", "Grid", "Content"], children);

        // This Tile element is containable, which means it can be added to any container, including Tiles.
        self.isContainable = true;

        // Used by the layout editor to determine if it should launch
        // the element editor dialog when creating new Tile elements.
        // Also used by our "LayoutEditor.Template.Tile.cshtml" view that is used as the layout-tile directive's template.
        self.hasEditor = hasEditor;

        // The element type name, which is sent back to the element editor controller when being edited.
        self.contentType = contentType;

        // The "layout-common-holder" CSS class is used by the layout editor to identify drop targets.
        self.dropTargetClass = "layout-common-holder";

        // The configured background image URL and background size.
        self.backgroundUrl = backgroundUrl;
        self.backgroundSize = backgroundSize;

        // Implements the toObject serialization function.
        // This is called when the layout is being serialized into JSON.
        var toObject = self.toObject; // Get a reference to the default implementation before we override it.
        self.toObject = function () {
            var result = toObject(); // Invoke the original (base) implementation.
            result.children = self.childrenToObject();
            result.backgroundUrl = self.backgroundUrl;
            result.backgroundSize = self.backgroundSize;
            return result;
        };

        // Override the getEditorObject so we can include our backgroundSize property.
        // This is called when the element editor dialog is being invoked and we need to
        // pass in the client side values.
        var getEditorObjectBase = this.getEditorObject;
        this.getEditorObject = function () {
            var props = getEditorObjectBase();
            props.BackgroundSize = self.backgroundSize;
            return props;
        }

        // Executed after the element editor dialog closes.
        this.applyElementEditorModel = function (data) {
            self.backgroundUrl = data.backgroundUrl;
            self.backgroundSize = data.backgroundSize;
            self.applyBackground();
        }

        this.hasBackground = function () {
            return self.backgroundUrl && self.backgroundUrl.length > 0;
        };

        this.applyBackground = function () {
            if (self.hasBackground()) {
                var styles = {
                    "background-image": "url('" + self.backgroundUrl + "')",
                    "background-size": self.backgroundSize && self.backgroundSize.length > 0 ? self.backgroundSize : "cover"
                };

                if (self.children.length == 0)
                    self.templateStyles = styles;
                else
                    self.containerTemplateStyles = styles;
            }
            else {
                self.templateStyles = {};
                self.containerTemplateStyles = {};
            }
        }

        self.applyBackground();
    };

    // Registers the factory function with the element factory.
    LayoutEditor.registerFactory("Tile", function (value) {
        return new LayoutEditor.Tile(
            value.data,
            value.contentType,
            value.htmlId,
            value.htmlClass,
            value.htmlStyle,
            value.isTemplated,
            value.rule,
            value.hasEditor,
            value.backgroundUrl,
            value.backgroundSize,
            LayoutEditor.childrenFrom(value.children));
    });

})(LayoutEditor || (LayoutEditor = {}));

//var LayoutEditor;
//(function (LayoutEditor) {

//    LayoutEditor.Tile = function (data, contentType, htmlId, htmlClass, htmlStyle, isTemplated, rule, hasEditor, backgroundUrl, backgroundSize, children) {
//        var self = this;

//        // Inherit from the Element base class.
//        LayoutEditor.Element.call(self, "Tile", data, htmlId, htmlClass, htmlStyle, isTemplated, rule);

//        // Inherit from the Container base class.
//        LayoutEditor.Container.call(self, ["Canvas", "Grid", "Content"], children);

//        // This Tile element is containable, which means it can be added to any container, including Tiles.
//        self.isContainable = true;

//        // Used by the layout editor to determine if it should launch
//        // the element editor dialog when creating new Tile elements.
//        // Also used by our "LayoutEditor.Template.Tile.cshtml" view that is used as the layout-tile directive's template.
//        self.hasEditor = hasEditor;

//        // The element type name, which is sent back to the element editor controller when being edited.
//        self.contentType = contentType;

//        // The "layout-common-holder" CSS class is used by the layout editor to identify drop targets.
//        self.dropTargetClass = "layout-common-holder";

//        // The configured background image URL and background size.
//        self.backgroundUrl = backgroundUrl;
//        self.backgroundSize = backgroundSize;

//        // Implements the toObject serialization function.
//        // This is called when the layout is being serialized into JSON.
//        var toObject = self.toObject; // Get a reference to the default implementation before we override it.
//        self.toObject = function () {
//            var result = toObject(); // Invoke the original (base) implementation.
//            result.children = self.childrenToObject();
//            result.backgroundUrl = self.backgroundUrl;
//            result.backgroundSize = self.backgroundSize;
//            return result;
//        };

//        // Override the getEditorObject so we can include our backgroundSize property.
//        // This is called when the element editor dialog is being invoked and we need to
//        // pass in the client side values.
//        var getEditorObjectBase = this.getEditorObject;
//        this.getEditorObject = function () {
//            var props = getEditorObjectBase();
//            props.BackgroundSize = self.backgroundSize;
//            return props;
//        }

//        // Executed after the element editor dialog closes.
//        this.applyElementEditorModel = function (data) {
//            self.backgroundUrl = data.backgroundUrl;
//            self.backgroundSize = data.backgroundSize;
//            self.applyBackground();
//        }

//        this.hasBackground = function () {
//            return self.backgroundUrl && self.backgroundUrl.length > 0;
//        };

//        this.applyBackground = function () {
//            if (self.hasBackground()) {
//                var styles = {
//                    "background-image": "url('" + self.backgroundUrl + "')",
//                    "background-size": self.backgroundSize && self.backgroundSize.length > 0 ? self.backgroundSize : "cover"
//                };

//                if (self.children.length == 0)
//                    self.templateStyles = styles;
//                else
//                    self.containerTemplateStyles = styles;
//            }
//            else {
//                self.templateStyles = {};
//                self.containerTemplateStyles = {};
//            }
//        }

//        self.applyBackground();
//    };

//    // Registers the factory function with the element factory.
//    LayoutEditor.registerFactory("Tile", function (value) {
//        var tile = new LayoutEditor.Tile(
//            value.data,
//            value.contentType,
//            value.htmlId,
//            value.htmlClass,
//            value.htmlStyle,
//            value.isTemplated,
//            value.rule,
//            value.hasEditor,
//            value.backgroundUrl,
//            value.backgroundSize,
//            LayoutEditor.childrenFrom(value.children));
//    });

//})(LayoutEditor || (LayoutEditor = {}));

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlRpbGVFbGVtZW50LmpzIiwiRGlyZWN0aXZlLmpzIiwiTW9kZWwuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEFDTEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDdkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6IlRpbGVFbGVtZW50LmpzIiwic291cmNlc0NvbnRlbnQiOltudWxsLCJhbmd1bGFyXHJcbiAgICAubW9kdWxlKFwiTGF5b3V0RWRpdG9yXCIpXHJcbiAgICAuZGlyZWN0aXZlKFwib3JjTGF5b3V0VGlsZVwiLCBbXCJzY29wZUNvbmZpZ3VyYXRvclwiLCBcImVudmlyb25tZW50XCIsXHJcbiAgICAgICAgZnVuY3Rpb24gKHNjb3BlQ29uZmlndXJhdG9yLCBlbnZpcm9ubWVudCkge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgcmVzdHJpY3Q6IFwiRVwiLFxyXG4gICAgICAgICAgICAgICAgc2NvcGU6IHsgZWxlbWVudDogXCI9XCIgfSxcclxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6IFtcIiRzY29wZVwiLCBcIiRlbGVtZW50XCIsIFwiJGF0dHJzXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKCRzY29wZSwgJGVsZW1lbnQsICRhdHRycykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZUNvbmZpZ3VyYXRvci5jb25maWd1cmVGb3JFbGVtZW50KCRzY29wZSwgJGVsZW1lbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZUNvbmZpZ3VyYXRvci5jb25maWd1cmVGb3JDb250YWluZXIoJHNjb3BlLCAkZWxlbWVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zb3J0YWJsZU9wdGlvbnNbXCJheGlzXCJdID0gXCJ5XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgXSxcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiBlbnZpcm9ubWVudC50ZW1wbGF0ZVVybChcIlRpbGVcIiksXHJcbiAgICAgICAgICAgICAgICByZXBsYWNlOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgbGluazogZnVuY3Rpb24gKCRzY29wZSwgJGVsZW1lbnQsICRhdHRycykge1xyXG4gICAgICAgICAgICAgICAgICAgICRlbGVtZW50Lm9uKFwiY2hhbmdlXCIsIFwiW25nLW1vZGVsPSdlbGVtZW50LmJhY2tncm91bmRTaXplJ11cIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZWxlbWVudC5hcHBseUJhY2tncm91bmQoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICBdKTsiLCJ2YXIgTGF5b3V0RWRpdG9yO1xyXG4oZnVuY3Rpb24gKExheW91dEVkaXRvcikge1xyXG5cclxuICAgIExheW91dEVkaXRvci5UaWxlID0gZnVuY3Rpb24gKGRhdGEsIGNvbnRlbnRUeXBlLCBodG1sSWQsIGh0bWxDbGFzcywgaHRtbFN0eWxlLCBpc1RlbXBsYXRlZCwgcnVsZSwgaGFzRWRpdG9yLCBiYWNrZ3JvdW5kVXJsLCBiYWNrZ3JvdW5kU2l6ZSwgY2hpbGRyZW4pIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcblxyXG4gICAgICAgIC8vIEluaGVyaXQgZnJvbSB0aGUgRWxlbWVudCBiYXNlIGNsYXNzLlxyXG4gICAgICAgIExheW91dEVkaXRvci5FbGVtZW50LmNhbGwoc2VsZiwgXCJUaWxlXCIsIGRhdGEsIGh0bWxJZCwgaHRtbENsYXNzLCBodG1sU3R5bGUsIGlzVGVtcGxhdGVkLCBydWxlKTtcclxuXHJcbiAgICAgICAgLy8gSW5oZXJpdCBmcm9tIHRoZSBDb250YWluZXIgYmFzZSBjbGFzcy5cclxuICAgICAgICBMYXlvdXRFZGl0b3IuQ29udGFpbmVyLmNhbGwoc2VsZiwgW1wiQ2FudmFzXCIsIFwiR3JpZFwiLCBcIkNvbnRlbnRcIl0sIGNoaWxkcmVuKTtcclxuXHJcbiAgICAgICAgLy8gVGhpcyBUaWxlIGVsZW1lbnQgaXMgY29udGFpbmFibGUsIHdoaWNoIG1lYW5zIGl0IGNhbiBiZSBhZGRlZCB0byBhbnkgY29udGFpbmVyLCBpbmNsdWRpbmcgVGlsZXMuXHJcbiAgICAgICAgc2VsZi5pc0NvbnRhaW5hYmxlID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgLy8gVXNlZCBieSB0aGUgbGF5b3V0IGVkaXRvciB0byBkZXRlcm1pbmUgaWYgaXQgc2hvdWxkIGxhdW5jaFxyXG4gICAgICAgIC8vIHRoZSBlbGVtZW50IGVkaXRvciBkaWFsb2cgd2hlbiBjcmVhdGluZyBuZXcgVGlsZSBlbGVtZW50cy5cclxuICAgICAgICAvLyBBbHNvIHVzZWQgYnkgb3VyIFwiTGF5b3V0RWRpdG9yLlRlbXBsYXRlLlRpbGUuY3NodG1sXCIgdmlldyB0aGF0IGlzIHVzZWQgYXMgdGhlIGxheW91dC10aWxlIGRpcmVjdGl2ZSdzIHRlbXBsYXRlLlxyXG4gICAgICAgIHNlbGYuaGFzRWRpdG9yID0gaGFzRWRpdG9yO1xyXG5cclxuICAgICAgICAvLyBUaGUgZWxlbWVudCB0eXBlIG5hbWUsIHdoaWNoIGlzIHNlbnQgYmFjayB0byB0aGUgZWxlbWVudCBlZGl0b3IgY29udHJvbGxlciB3aGVuIGJlaW5nIGVkaXRlZC5cclxuICAgICAgICBzZWxmLmNvbnRlbnRUeXBlID0gY29udGVudFR5cGU7XHJcblxyXG4gICAgICAgIC8vIFRoZSBcImxheW91dC1jb21tb24taG9sZGVyXCIgQ1NTIGNsYXNzIGlzIHVzZWQgYnkgdGhlIGxheW91dCBlZGl0b3IgdG8gaWRlbnRpZnkgZHJvcCB0YXJnZXRzLlxyXG4gICAgICAgIHNlbGYuZHJvcFRhcmdldENsYXNzID0gXCJsYXlvdXQtY29tbW9uLWhvbGRlclwiO1xyXG5cclxuICAgICAgICAvLyBUaGUgY29uZmlndXJlZCBiYWNrZ3JvdW5kIGltYWdlIFVSTCBhbmQgYmFja2dyb3VuZCBzaXplLlxyXG4gICAgICAgIHNlbGYuYmFja2dyb3VuZFVybCA9IGJhY2tncm91bmRVcmw7XHJcbiAgICAgICAgc2VsZi5iYWNrZ3JvdW5kU2l6ZSA9IGJhY2tncm91bmRTaXplO1xyXG5cclxuICAgICAgICAvLyBJbXBsZW1lbnRzIHRoZSB0b09iamVjdCBzZXJpYWxpemF0aW9uIGZ1bmN0aW9uLlxyXG4gICAgICAgIC8vIFRoaXMgaXMgY2FsbGVkIHdoZW4gdGhlIGxheW91dCBpcyBiZWluZyBzZXJpYWxpemVkIGludG8gSlNPTi5cclxuICAgICAgICB2YXIgdG9PYmplY3QgPSBzZWxmLnRvT2JqZWN0OyAvLyBHZXQgYSByZWZlcmVuY2UgdG8gdGhlIGRlZmF1bHQgaW1wbGVtZW50YXRpb24gYmVmb3JlIHdlIG92ZXJyaWRlIGl0LlxyXG4gICAgICAgIHNlbGYudG9PYmplY3QgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSB0b09iamVjdCgpOyAvLyBJbnZva2UgdGhlIG9yaWdpbmFsIChiYXNlKSBpbXBsZW1lbnRhdGlvbi5cclxuICAgICAgICAgICAgcmVzdWx0LmNoaWxkcmVuID0gc2VsZi5jaGlsZHJlblRvT2JqZWN0KCk7XHJcbiAgICAgICAgICAgIHJlc3VsdC5iYWNrZ3JvdW5kVXJsID0gc2VsZi5iYWNrZ3JvdW5kVXJsO1xyXG4gICAgICAgICAgICByZXN1bHQuYmFja2dyb3VuZFNpemUgPSBzZWxmLmJhY2tncm91bmRTaXplO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8vIE92ZXJyaWRlIHRoZSBnZXRFZGl0b3JPYmplY3Qgc28gd2UgY2FuIGluY2x1ZGUgb3VyIGJhY2tncm91bmRTaXplIHByb3BlcnR5LlxyXG4gICAgICAgIC8vIFRoaXMgaXMgY2FsbGVkIHdoZW4gdGhlIGVsZW1lbnQgZWRpdG9yIGRpYWxvZyBpcyBiZWluZyBpbnZva2VkIGFuZCB3ZSBuZWVkIHRvXHJcbiAgICAgICAgLy8gcGFzcyBpbiB0aGUgY2xpZW50IHNpZGUgdmFsdWVzLlxyXG4gICAgICAgIHZhciBnZXRFZGl0b3JPYmplY3RCYXNlID0gdGhpcy5nZXRFZGl0b3JPYmplY3Q7XHJcbiAgICAgICAgdGhpcy5nZXRFZGl0b3JPYmplY3QgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBwcm9wcyA9IGdldEVkaXRvck9iamVjdEJhc2UoKTtcclxuICAgICAgICAgICAgcHJvcHMuQmFja2dyb3VuZFNpemUgPSBzZWxmLmJhY2tncm91bmRTaXplO1xyXG4gICAgICAgICAgICByZXR1cm4gcHJvcHM7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBFeGVjdXRlZCBhZnRlciB0aGUgZWxlbWVudCBlZGl0b3IgZGlhbG9nIGNsb3Nlcy5cclxuICAgICAgICB0aGlzLmFwcGx5RWxlbWVudEVkaXRvck1vZGVsID0gZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgc2VsZi5iYWNrZ3JvdW5kVXJsID0gZGF0YS5iYWNrZ3JvdW5kVXJsO1xyXG4gICAgICAgICAgICBzZWxmLmJhY2tncm91bmRTaXplID0gZGF0YS5iYWNrZ3JvdW5kU2l6ZTtcclxuICAgICAgICAgICAgc2VsZi5hcHBseUJhY2tncm91bmQoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuaGFzQmFja2dyb3VuZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHNlbGYuYmFja2dyb3VuZFVybCAmJiBzZWxmLmJhY2tncm91bmRVcmwubGVuZ3RoID4gMDtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB0aGlzLmFwcGx5QmFja2dyb3VuZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKHNlbGYuaGFzQmFja2dyb3VuZCgpKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgc3R5bGVzID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIFwiYmFja2dyb3VuZC1pbWFnZVwiOiBcInVybCgnXCIgKyBzZWxmLmJhY2tncm91bmRVcmwgKyBcIicpXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgXCJiYWNrZ3JvdW5kLXNpemVcIjogc2VsZi5iYWNrZ3JvdW5kU2l6ZSAmJiBzZWxmLmJhY2tncm91bmRTaXplLmxlbmd0aCA+IDAgPyBzZWxmLmJhY2tncm91bmRTaXplIDogXCJjb3ZlclwiXHJcbiAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChzZWxmLmNoaWxkcmVuLmxlbmd0aCA9PSAwKVxyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYudGVtcGxhdGVTdHlsZXMgPSBzdHlsZXM7XHJcbiAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5jb250YWluZXJUZW1wbGF0ZVN0eWxlcyA9IHN0eWxlcztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHNlbGYudGVtcGxhdGVTdHlsZXMgPSB7fTtcclxuICAgICAgICAgICAgICAgIHNlbGYuY29udGFpbmVyVGVtcGxhdGVTdHlsZXMgPSB7fTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgc2VsZi5hcHBseUJhY2tncm91bmQoKTtcclxuICAgIH07XHJcblxyXG4gICAgLy8gUmVnaXN0ZXJzIHRoZSBmYWN0b3J5IGZ1bmN0aW9uIHdpdGggdGhlIGVsZW1lbnQgZmFjdG9yeS5cclxuICAgIExheW91dEVkaXRvci5yZWdpc3RlckZhY3RvcnkoXCJUaWxlXCIsIGZ1bmN0aW9uICh2YWx1ZSkge1xyXG4gICAgICAgIHJldHVybiBuZXcgTGF5b3V0RWRpdG9yLlRpbGUoXHJcbiAgICAgICAgICAgIHZhbHVlLmRhdGEsXHJcbiAgICAgICAgICAgIHZhbHVlLmNvbnRlbnRUeXBlLFxyXG4gICAgICAgICAgICB2YWx1ZS5odG1sSWQsXHJcbiAgICAgICAgICAgIHZhbHVlLmh0bWxDbGFzcyxcclxuICAgICAgICAgICAgdmFsdWUuaHRtbFN0eWxlLFxyXG4gICAgICAgICAgICB2YWx1ZS5pc1RlbXBsYXRlZCxcclxuICAgICAgICAgICAgdmFsdWUucnVsZSxcclxuICAgICAgICAgICAgdmFsdWUuaGFzRWRpdG9yLFxyXG4gICAgICAgICAgICB2YWx1ZS5iYWNrZ3JvdW5kVXJsLFxyXG4gICAgICAgICAgICB2YWx1ZS5iYWNrZ3JvdW5kU2l6ZSxcclxuICAgICAgICAgICAgTGF5b3V0RWRpdG9yLmNoaWxkcmVuRnJvbSh2YWx1ZS5jaGlsZHJlbikpO1xyXG4gICAgfSk7XHJcblxyXG59KShMYXlvdXRFZGl0b3IgfHwgKExheW91dEVkaXRvciA9IHt9KSk7XHJcblxyXG4vL3ZhciBMYXlvdXRFZGl0b3I7XHJcbi8vKGZ1bmN0aW9uIChMYXlvdXRFZGl0b3IpIHtcclxuXHJcbi8vICAgIExheW91dEVkaXRvci5UaWxlID0gZnVuY3Rpb24gKGRhdGEsIGNvbnRlbnRUeXBlLCBodG1sSWQsIGh0bWxDbGFzcywgaHRtbFN0eWxlLCBpc1RlbXBsYXRlZCwgcnVsZSwgaGFzRWRpdG9yLCBiYWNrZ3JvdW5kVXJsLCBiYWNrZ3JvdW5kU2l6ZSwgY2hpbGRyZW4pIHtcclxuLy8gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuXHJcbi8vICAgICAgICAvLyBJbmhlcml0IGZyb20gdGhlIEVsZW1lbnQgYmFzZSBjbGFzcy5cclxuLy8gICAgICAgIExheW91dEVkaXRvci5FbGVtZW50LmNhbGwoc2VsZiwgXCJUaWxlXCIsIGRhdGEsIGh0bWxJZCwgaHRtbENsYXNzLCBodG1sU3R5bGUsIGlzVGVtcGxhdGVkLCBydWxlKTtcclxuXHJcbi8vICAgICAgICAvLyBJbmhlcml0IGZyb20gdGhlIENvbnRhaW5lciBiYXNlIGNsYXNzLlxyXG4vLyAgICAgICAgTGF5b3V0RWRpdG9yLkNvbnRhaW5lci5jYWxsKHNlbGYsIFtcIkNhbnZhc1wiLCBcIkdyaWRcIiwgXCJDb250ZW50XCJdLCBjaGlsZHJlbik7XHJcblxyXG4vLyAgICAgICAgLy8gVGhpcyBUaWxlIGVsZW1lbnQgaXMgY29udGFpbmFibGUsIHdoaWNoIG1lYW5zIGl0IGNhbiBiZSBhZGRlZCB0byBhbnkgY29udGFpbmVyLCBpbmNsdWRpbmcgVGlsZXMuXHJcbi8vICAgICAgICBzZWxmLmlzQ29udGFpbmFibGUgPSB0cnVlO1xyXG5cclxuLy8gICAgICAgIC8vIFVzZWQgYnkgdGhlIGxheW91dCBlZGl0b3IgdG8gZGV0ZXJtaW5lIGlmIGl0IHNob3VsZCBsYXVuY2hcclxuLy8gICAgICAgIC8vIHRoZSBlbGVtZW50IGVkaXRvciBkaWFsb2cgd2hlbiBjcmVhdGluZyBuZXcgVGlsZSBlbGVtZW50cy5cclxuLy8gICAgICAgIC8vIEFsc28gdXNlZCBieSBvdXIgXCJMYXlvdXRFZGl0b3IuVGVtcGxhdGUuVGlsZS5jc2h0bWxcIiB2aWV3IHRoYXQgaXMgdXNlZCBhcyB0aGUgbGF5b3V0LXRpbGUgZGlyZWN0aXZlJ3MgdGVtcGxhdGUuXHJcbi8vICAgICAgICBzZWxmLmhhc0VkaXRvciA9IGhhc0VkaXRvcjtcclxuXHJcbi8vICAgICAgICAvLyBUaGUgZWxlbWVudCB0eXBlIG5hbWUsIHdoaWNoIGlzIHNlbnQgYmFjayB0byB0aGUgZWxlbWVudCBlZGl0b3IgY29udHJvbGxlciB3aGVuIGJlaW5nIGVkaXRlZC5cclxuLy8gICAgICAgIHNlbGYuY29udGVudFR5cGUgPSBjb250ZW50VHlwZTtcclxuXHJcbi8vICAgICAgICAvLyBUaGUgXCJsYXlvdXQtY29tbW9uLWhvbGRlclwiIENTUyBjbGFzcyBpcyB1c2VkIGJ5IHRoZSBsYXlvdXQgZWRpdG9yIHRvIGlkZW50aWZ5IGRyb3AgdGFyZ2V0cy5cclxuLy8gICAgICAgIHNlbGYuZHJvcFRhcmdldENsYXNzID0gXCJsYXlvdXQtY29tbW9uLWhvbGRlclwiO1xyXG5cclxuLy8gICAgICAgIC8vIFRoZSBjb25maWd1cmVkIGJhY2tncm91bmQgaW1hZ2UgVVJMIGFuZCBiYWNrZ3JvdW5kIHNpemUuXHJcbi8vICAgICAgICBzZWxmLmJhY2tncm91bmRVcmwgPSBiYWNrZ3JvdW5kVXJsO1xyXG4vLyAgICAgICAgc2VsZi5iYWNrZ3JvdW5kU2l6ZSA9IGJhY2tncm91bmRTaXplO1xyXG5cclxuLy8gICAgICAgIC8vIEltcGxlbWVudHMgdGhlIHRvT2JqZWN0IHNlcmlhbGl6YXRpb24gZnVuY3Rpb24uXHJcbi8vICAgICAgICAvLyBUaGlzIGlzIGNhbGxlZCB3aGVuIHRoZSBsYXlvdXQgaXMgYmVpbmcgc2VyaWFsaXplZCBpbnRvIEpTT04uXHJcbi8vICAgICAgICB2YXIgdG9PYmplY3QgPSBzZWxmLnRvT2JqZWN0OyAvLyBHZXQgYSByZWZlcmVuY2UgdG8gdGhlIGRlZmF1bHQgaW1wbGVtZW50YXRpb24gYmVmb3JlIHdlIG92ZXJyaWRlIGl0LlxyXG4vLyAgICAgICAgc2VsZi50b09iamVjdCA9IGZ1bmN0aW9uICgpIHtcclxuLy8gICAgICAgICAgICB2YXIgcmVzdWx0ID0gdG9PYmplY3QoKTsgLy8gSW52b2tlIHRoZSBvcmlnaW5hbCAoYmFzZSkgaW1wbGVtZW50YXRpb24uXHJcbi8vICAgICAgICAgICAgcmVzdWx0LmNoaWxkcmVuID0gc2VsZi5jaGlsZHJlblRvT2JqZWN0KCk7XHJcbi8vICAgICAgICAgICAgcmVzdWx0LmJhY2tncm91bmRVcmwgPSBzZWxmLmJhY2tncm91bmRVcmw7XHJcbi8vICAgICAgICAgICAgcmVzdWx0LmJhY2tncm91bmRTaXplID0gc2VsZi5iYWNrZ3JvdW5kU2l6ZTtcclxuLy8gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4vLyAgICAgICAgfTtcclxuXHJcbi8vICAgICAgICAvLyBPdmVycmlkZSB0aGUgZ2V0RWRpdG9yT2JqZWN0IHNvIHdlIGNhbiBpbmNsdWRlIG91ciBiYWNrZ3JvdW5kU2l6ZSBwcm9wZXJ0eS5cclxuLy8gICAgICAgIC8vIFRoaXMgaXMgY2FsbGVkIHdoZW4gdGhlIGVsZW1lbnQgZWRpdG9yIGRpYWxvZyBpcyBiZWluZyBpbnZva2VkIGFuZCB3ZSBuZWVkIHRvXHJcbi8vICAgICAgICAvLyBwYXNzIGluIHRoZSBjbGllbnQgc2lkZSB2YWx1ZXMuXHJcbi8vICAgICAgICB2YXIgZ2V0RWRpdG9yT2JqZWN0QmFzZSA9IHRoaXMuZ2V0RWRpdG9yT2JqZWN0O1xyXG4vLyAgICAgICAgdGhpcy5nZXRFZGl0b3JPYmplY3QgPSBmdW5jdGlvbiAoKSB7XHJcbi8vICAgICAgICAgICAgdmFyIHByb3BzID0gZ2V0RWRpdG9yT2JqZWN0QmFzZSgpO1xyXG4vLyAgICAgICAgICAgIHByb3BzLkJhY2tncm91bmRTaXplID0gc2VsZi5iYWNrZ3JvdW5kU2l6ZTtcclxuLy8gICAgICAgICAgICByZXR1cm4gcHJvcHM7XHJcbi8vICAgICAgICB9XHJcblxyXG4vLyAgICAgICAgLy8gRXhlY3V0ZWQgYWZ0ZXIgdGhlIGVsZW1lbnQgZWRpdG9yIGRpYWxvZyBjbG9zZXMuXHJcbi8vICAgICAgICB0aGlzLmFwcGx5RWxlbWVudEVkaXRvck1vZGVsID0gZnVuY3Rpb24gKGRhdGEpIHtcclxuLy8gICAgICAgICAgICBzZWxmLmJhY2tncm91bmRVcmwgPSBkYXRhLmJhY2tncm91bmRVcmw7XHJcbi8vICAgICAgICAgICAgc2VsZi5iYWNrZ3JvdW5kU2l6ZSA9IGRhdGEuYmFja2dyb3VuZFNpemU7XHJcbi8vICAgICAgICAgICAgc2VsZi5hcHBseUJhY2tncm91bmQoKTtcclxuLy8gICAgICAgIH1cclxuXHJcbi8vICAgICAgICB0aGlzLmhhc0JhY2tncm91bmQgPSBmdW5jdGlvbiAoKSB7XHJcbi8vICAgICAgICAgICAgcmV0dXJuIHNlbGYuYmFja2dyb3VuZFVybCAmJiBzZWxmLmJhY2tncm91bmRVcmwubGVuZ3RoID4gMDtcclxuLy8gICAgICAgIH07XHJcblxyXG4vLyAgICAgICAgdGhpcy5hcHBseUJhY2tncm91bmQgPSBmdW5jdGlvbiAoKSB7XHJcbi8vICAgICAgICAgICAgaWYgKHNlbGYuaGFzQmFja2dyb3VuZCgpKSB7XHJcbi8vICAgICAgICAgICAgICAgIHZhciBzdHlsZXMgPSB7XHJcbi8vICAgICAgICAgICAgICAgICAgICBcImJhY2tncm91bmQtaW1hZ2VcIjogXCJ1cmwoJ1wiICsgc2VsZi5iYWNrZ3JvdW5kVXJsICsgXCInKVwiLFxyXG4vLyAgICAgICAgICAgICAgICAgICAgXCJiYWNrZ3JvdW5kLXNpemVcIjogc2VsZi5iYWNrZ3JvdW5kU2l6ZSAmJiBzZWxmLmJhY2tncm91bmRTaXplLmxlbmd0aCA+IDAgPyBzZWxmLmJhY2tncm91bmRTaXplIDogXCJjb3ZlclwiXHJcbi8vICAgICAgICAgICAgICAgIH07XHJcblxyXG4vLyAgICAgICAgICAgICAgICBpZiAoc2VsZi5jaGlsZHJlbi5sZW5ndGggPT0gMClcclxuLy8gICAgICAgICAgICAgICAgICAgIHNlbGYudGVtcGxhdGVTdHlsZXMgPSBzdHlsZXM7XHJcbi8vICAgICAgICAgICAgICAgIGVsc2VcclxuLy8gICAgICAgICAgICAgICAgICAgIHNlbGYuY29udGFpbmVyVGVtcGxhdGVTdHlsZXMgPSBzdHlsZXM7XHJcbi8vICAgICAgICAgICAgfVxyXG4vLyAgICAgICAgICAgIGVsc2Uge1xyXG4vLyAgICAgICAgICAgICAgICBzZWxmLnRlbXBsYXRlU3R5bGVzID0ge307XHJcbi8vICAgICAgICAgICAgICAgIHNlbGYuY29udGFpbmVyVGVtcGxhdGVTdHlsZXMgPSB7fTtcclxuLy8gICAgICAgICAgICB9XHJcbi8vICAgICAgICB9XHJcblxyXG4vLyAgICAgICAgc2VsZi5hcHBseUJhY2tncm91bmQoKTtcclxuLy8gICAgfTtcclxuXHJcbi8vICAgIC8vIFJlZ2lzdGVycyB0aGUgZmFjdG9yeSBmdW5jdGlvbiB3aXRoIHRoZSBlbGVtZW50IGZhY3RvcnkuXHJcbi8vICAgIExheW91dEVkaXRvci5yZWdpc3RlckZhY3RvcnkoXCJUaWxlXCIsIGZ1bmN0aW9uICh2YWx1ZSkge1xyXG4vLyAgICAgICAgdmFyIHRpbGUgPSBuZXcgTGF5b3V0RWRpdG9yLlRpbGUoXHJcbi8vICAgICAgICAgICAgdmFsdWUuZGF0YSxcclxuLy8gICAgICAgICAgICB2YWx1ZS5jb250ZW50VHlwZSxcclxuLy8gICAgICAgICAgICB2YWx1ZS5odG1sSWQsXHJcbi8vICAgICAgICAgICAgdmFsdWUuaHRtbENsYXNzLFxyXG4vLyAgICAgICAgICAgIHZhbHVlLmh0bWxTdHlsZSxcclxuLy8gICAgICAgICAgICB2YWx1ZS5pc1RlbXBsYXRlZCxcclxuLy8gICAgICAgICAgICB2YWx1ZS5ydWxlLFxyXG4vLyAgICAgICAgICAgIHZhbHVlLmhhc0VkaXRvcixcclxuLy8gICAgICAgICAgICB2YWx1ZS5iYWNrZ3JvdW5kVXJsLFxyXG4vLyAgICAgICAgICAgIHZhbHVlLmJhY2tncm91bmRTaXplLFxyXG4vLyAgICAgICAgICAgIExheW91dEVkaXRvci5jaGlsZHJlbkZyb20odmFsdWUuY2hpbGRyZW4pKTtcclxuLy8gICAgfSk7XHJcblxyXG4vL30pKExheW91dEVkaXRvciB8fCAoTGF5b3V0RWRpdG9yID0ge30pKTtcclxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
